let CustomErrorHandler,JwtService;_305‍.x([["default",()=>_305‍.o]]);_305‍.w("../services/CustomErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);_305‍.w("../services/JwtService",[["default",["JwtService"],function(v){JwtService=v}]]);


const auth = async (req, res, next)=>{
    //Getting Token from header
    let authHeader = req.headers.authorization;
    
    if(!authHeader){
        return next(CustomErrorHandler.unAuthorized());
    }
    
    const token = authHeader.split(' ')[1];
    try {
        //Verify the token and extracting id and role of user
        const {_id, role} = await JwtService.verify(token);
        req.user ={

        }
        req.user._id= _id;
        req.user.role=role;
        next();
        
    } catch (error) {
        return next(CustomErrorHandler.unAuthorized());
    }
}


_305‍.d(auth);
